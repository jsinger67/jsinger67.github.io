<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Changes in version 4 - The Parol Parser Generator</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Parol Parser Generator</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="changes-in-version-4"><a class="header" href="#changes-in-version-4">Changes in version 4</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Version 4 of Parol introduces significant changes that may affect existing projects and workflows.
This document summarizes all updates, breaking changes, and migration hints for users upgrading from
previous versions.</p>
<hr />
<h2 id="major-changes"><a class="header" href="#major-changes">Major Changes</a></h2>
<h3 id="1-switch-to-scnr2-scanner-crate"><a class="header" href="#1-switch-to-scnr2-scanner-crate">1. Switch to <code>scnr2</code> Scanner Crate</a></h3>
<p>Parol now uses the <a href="https://crates.io/crates/scnr2"><code>scnr2</code></a> scanner crate for lexical analysis.
This change improves performance and maintainability but may require adjustments in custom scanner
configurations.</p>
<p><strong>Impact:</strong></p>
<ul>
<li>All scanner-related features are now based on <code>scnr2</code>.</li>
<li>Custom scanner switching logic must be adapted to the new API.</li>
</ul>
<h3 id="2-removal-of-parser-based-scanner-switching"><a class="header" href="#2-removal-of-parser-based-scanner-switching">2. Removal of Parser-Based Scanner Switching</a></h3>
<p>Support for parser-based scanner switching has been removed. Scanner switching is now exclusively
handled by the scanner itself.</p>
<p><strong>Impact:</strong></p>
<ul>
<li>Any grammar or code relying on parser-driven scanner switching must be refactored.</li>
<li>See migration notes below.</li>
</ul>
<hr />
<h3 id="scanner-mode-switching-in-version-4"><a class="header" href="#scanner-mode-switching-in-version-4">Scanner Mode Switching in Version 4</a></h3>
<p>Scanner mode switching in Parol version 4 is now exclusively managed by the scanner, using the
<code>%enter</code>, <code>%push</code>, and <code>%pop</code> directives within the scanner specification. These directives allow
you to:</p>
<ul>
<li><code>%enter</code>: Switch the scanner to a specific mode, replacing the current mode.</li>
<li><code>%push</code>: Push the current mode onto a stack and enter a new mode.</li>
<li><code>%pop</code>: Return to the previous mode by popping the mode stack.</li>
</ul>
<blockquote>
<p><strong>Note:</strong> The <code>%sc</code>, <code>%push</code>, and <code>%pop</code> commands are no longer available within grammar
productions. This means that parser-based scanner mode switching is not supported in version 4.</p>
</blockquote>
<p>This change was necessary because lookahead in LL(k) grammars with k &gt; 1 can cause the token buffer
to become unsynchronized if tokens are read in the wrong scanner mode. By restricting mode switching
to the scanner, Parol ensures that tokenization remains consistent and reliable, regardless of
parser lookahead.</p>
<p>Note that Parol generates all the data required by the <a href="https://crates.io/crates/scnr2"><code>scnr2</code></a>
crate to construct valid and efficient scanners. Users should not have to know how <code>scnr</code> works and
how it is configured.</p>
<h4 id="token-priority"><a class="header" href="#token-priority">Token Priority</a></h4>
<p>As in previous versions, terminals defined earlier in the grammar have higher priority than those
defined later. This allows you to influence the priority of tokens with equal length. In all other
cases, tokens with the longest match are preferred.</p>
<hr />
<h2 id="migration-notes"><a class="header" href="#migration-notes">Migration Notes</a></h2>
<ul>
<li>Review your grammar files for any use of parser-based scanner switching and update them to use
scanner-based switching.</li>
<li>See <a href="./ParGrammar.html#scanner-based-scanner-switching">Grammar description syntax</a> for details on
scanner-based scanner switching. In addition to <code>%enter</code> described there as of version 4 you have
the aforementioned <code>%push</code> and <code>%pop</code> instructions additionally available</li>
<li>Test your grammars and integrations thoroughly after upgrading.</li>
</ul>
<hr />
<h2 id="further-information"><a class="header" href="#further-information">Further Information</a></h2>
<p>For a complete list of changes, see the <a href="../../crates/parol/CHANGELOG.html">Changelog</a>.</p>
<p>If you encounter issues, please consult the <a href="./QnA.html">Q&amp;A</a> or open an issue on the
<a href="https://github.com/jsinger67/parol">Parol GitHub repository</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="ParolVersion3.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="ParolVersion3.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
